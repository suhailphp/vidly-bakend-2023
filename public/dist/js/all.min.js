/*!
 * Core App
 * Copyright 2014-2022 PSA Developing team
 */
function createCookie(e,t,a){let n="";if(a){const e=new Date;e.setTime(e.getTime()+24*a*60*60*1e3),n=`; expires=${e.toGMTString()}`}document.cookie=`${e}=${t}${n}; path=/`}function getCookie(e){const t=`${e}=`,a=decodeURIComponent(document.cookie).split(";");for(let e=0;e<a.length;e++){let n=a[e];for(;" "===n.charAt(0);)n=n.substring(1);if(0===n.indexOf(t))return n.substring(t.length,n.length)}return""}function getLang(){return getCookie("_lng")}function formatAmount(e){return wNumb({decimals:2,thousand:","}).to(e)}function changeLang(e){let t=!0;""===getLang()&&"ar"===e&&(t=!1),createCookie("_lng",e,365),t&&location.reload()}function getDir(){return"ar"===getCookie("_lng")?"rtl":"ltr"}function request(e,t={method:"GET"}){const a={"X-Requested-With":"XMLHttpRequest"};if(t.files||(a["Content-Type"]="application/json; charset=UTF-8"),t.form){const e=t.form;"function"==typeof jQuery&&e instanceof jQuery&&(t.body=new URLSearchParams(e.serialize())),e instanceof HTMLFormElement&&(t.body=new URLSearchParams(new FormData(e))),delete a["Content-Type"]}return fetch(BASE_URL+e,{...t,headers:a,credentials:"same-origin"}).then((async e=>{if(204===e.status||205===e.status)return null;if(401===e.status||403===e.status)throw new Error(__("You are not authorized to perform this action"));if(t.fetchFile)return e.blob();try{const t=e.headers.get("content-type");if(t&&-1!==t.indexOf("application/json")){const t=await e.text();return t?JSON.parse(t):null}if(t&&-1!==t.indexOf("text/html")){return await e.text()}return{}}catch(t){return e?e.json():null}})).then((e=>{if(e&&e.message&&!e.success){throw new Error(e.message)}return e}))}const defaultDateFormat="D MMM YYYY",defaultShortDateFormat="D-MM-YY",defaultDateTimeFormat="D MMM YYYY, h:mm A",defaultTimeFormat="h:mm A",organizationTypeColors=["#181C32","#50CD89","#7239EA","#009ef7","#FFC700","#F1416C","#fefefe"],operationLevelColors=["#50CD89","#009ef7","#fe9700","#F1416C","#FF9F00","#00A0FF","#00FF00","#FF0000","#0000FF","#000000"];toastr.options={closeButton:!0,debug:!1,newestOnTop:!0,progressBar:!0,positionClass:"toastr-top-right",preventDuplicates:!0,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};const PSA={__:(e,t={})=>{let a=__(e);for(const e of Object.keys(t))a=a.replace(`{{${e}}}`,t[e]);return a},defaults:{datatable:e=>({responsive:!0,autoWidth:!1,paging:!0,searching:!0,ordering:!0,info:!0,searchHighlight:!0,stateSave:!1,stateDuration:3600,processing:!0,serverSide:!0,ajax:{url:e&&e.url?e.url:window.location.href,data(e){if(e.order){const t=e.columns[e.order[0].column];e.order[0].column="function"===t.data?t.name:t.data}delete e.columns}},language:{url:"ar"===getLang()?"/assets/json/datatable.ar.json":""},drawCallback(e){PSA.tooltip.init(document.getElementsByClassName("tbl-tp")),KTMenu.createInstances();try{$(`#${e.sTableId}`).unhighlight(),$(`#${e.sTableId}`).highlight(e.oPreviousSearch.sSearch)}catch(e){}}}),validate:{errorElement:"span",errorPlacement(e,t){e.addClass("invalid-feedback")},highlight(e,t,a){$(e).parent().find("span.select2-selection").length?$(e).parent().find("span.select2-selection").addClass("is-invalid"):$(e).addClass("is-invalid")},unhighlight(e,t,a){$(e).parent().find("span.select2-selection").length?$(e).parent().find("span.select2-selection").removeClass("is-invalid"):$(e).removeClass("is-invalid")}},tinymce:{height:"480",toolbar:["undo redo | cut copy paste | bold italic | link | alignleft aligncenter alignright alignjustify ltr rtl","bullist numlist | outdent indent | blockquote subscript superscript | advlist | autolink | lists charmap | print preview"],plugins:"advlist autolink link lists charmap print preview directionality",hidden_input:!0,directionality:getDir(),language:getLang()}},toast:{success:(e,t=__("Success"))=>{toastr.success(e,t)},info:(e,t=__("Info"))=>{toastr.info(e,t)},warning:(e,t=__("Warning"))=>{toastr.warning(e,t)},error:(e,t=__("Error"))=>{toastr.error(e,t)},clear:()=>{toastr.clear()}},modal:{makeRef:e=>{const t=document.getElementById(e);return bootstrap.Modal.getOrCreateInstance(t,{backdrop:"static"})},show:e=>{PSA.modal.makeRef(e).show()},hide:e=>{PSA.modal.makeRef(e).hide()},toggle:e=>{PSA.modal.makeRef(e).toggle()},listenShow:(e,t)=>{document.getElementById(e).addEventListener("shown.bs.modal",t)},listenHide:(e,t)=>{document.getElementById(e).addEventListener("hide.bs.modal",t)}},event:{remove:(e,t)=>{window.removeEventListener(remove,t,!1)},listen:(e,t)=>{document.addEventListener(e,(e=>{t(e.detail)}))},trigger:(e,t)=>{const a=new CustomEvent(e,{detail:t});document.dispatchEvent(a)}},form:{reset(){window.location=window.location.pathname}},fv:{addField:(e,t)=>{e.addField(t,{validators:{notEmpty:{message:__("This Field is Required.")}}})},removeField:(e,t)=>{try{e.removeField(t)}catch(e){}},fieldsMaker:{comparePassword:(e,t)=>({[e]:{validators:{notEmpty:{message:"The password is required"},callback:{message:"Please enter valid password",callback(e){if(e.value.length>0)return validatePassword()}}}},[t]:{validators:{notEmpty:{message:"The password confirmation is required"},identical:{compare:()=>form.querySelector(`[name="${e}"]`).value,message:"The password and its confirm are not the same"}}}})},init:(e,t=[],a={},n={submit:!0})=>{const s=t;"string"==typeof e&&(e=document.getElementById(e)),t.length||e.querySelectorAll("[required]").forEach((e=>{s.push(e.name)}));const o={};for(const e of s)o[e]={validators:{notEmpty:{message:__("This Field is Required")}}};const r={trigger:new FormValidation.plugins.Trigger,submitButton:new FormValidation.plugins.SubmitButton,bootstrap:new FormValidation.plugins.Bootstrap5({rowSelector:".fv-row",eleInvalidClass:"",eleValidClass:""})};return n.submit&&(r.defaultSubmit=new FormValidation.plugins.DefaultSubmit),FormValidation.formValidation(e,{fields:{...o,...a},plugins:r})},onFormValidate:(e,t)=>{e.on("core.form.valid",t)},reset:e=>{e.resetForm({reset:!0})}},date:{dateFormat:e=>e?moment(e).format("D MMM YYYY"):"",dateFormatShort:e=>e?moment(e).format("D-MM-YY"):"",dateTimeFormat:e=>e?moment(e).format("D MMM YYYY, h:mm A"):"",timeFormat:e=>e?moment(e).format("h:mm A"):""},helpers:{capitalizeFirstLetter:e=>e?e.charAt(0).toUpperCase()+e.slice(1):"",dataURItoBlob(e){const t=atob(e.split(",")[1]),a=e.split(",")[0].split(":")[1].split(";")[0],n=new ArrayBuffer(t.length),s=new Uint8Array(n);for(let e=0;e<t.length;e++)s[e]=t.charCodeAt(e);return new Blob([n],{type:a})},getEmpName:e=>e&&"object"==typeof e?"ar"===getLang()?e.fullNameAr:e.fullNameEn:"",frequencyToText(e){const t=parseInt(e,10);return 12===t?__("Monthly"):4===t?__("Quarterly"):2===t?__("Half Yearly"):1===t?__("Yearly"):e},roundNumber(e,t=2){let a=e;return"string"==typeof a&&(a=number.toNumber(a)),"number"!=typeof a?null:Number(`${Math.round(`${a}e${t}`)}e-${t}`)}},tooltip:{init:e=>{const t="object"==typeof e?e:document.querySelectorAll(e);for(let e=0,a=t.length;e<a;e++)bootstrap.Tooltip.getOrCreateInstance(t[e])}},badges:{custom:(e,t,a,n)=>`<span class="badge ${t||""}" ${a||n?`style="background-color:${a};color:${n}!important;"`:""}>${e}</span>`,primary:(e,t=!1)=>PSA.badges.custom(e,`badge${t?"-light":""}-primary`),light:(e,t=!1)=>PSA.badges.custom(e,`badge${t?"-light":""}-light`),secondary:(e,t=!1)=>PSA.badges.custom(e,`badge${t?"-light":""}-secondary`),success:(e,t=!1)=>PSA.badges.custom(e,`badge${t?"-light":""}-success`),info:(e,t=!1)=>PSA.badges.custom(e,`badge${t?"-light":""}-info`),warning:(e,t=!1)=>PSA.badges.custom(e,`badge${t?"-light":""}-warning`),danger:(e,t=!1)=>PSA.badges.custom(e,`badge${t?"-light":""}-danger`),dark:(e,t=!1)=>PSA.badges.custom(e,`badge${t?"-light":""}-dark`),activeInactive:e=>e?PSA.badges.success(__("Active")):PSA.badges.danger(__("Inactive")),organizationLevel:(e,t,a,n="dark")=>{switch(e){case 0:return"light"===n?PSA.badges.custom(t||e,a?`badge-${a} badge-light-dark`:"",null,organizationTypeColors[0]):PSA.badges.custom(t||e,a?`badge-${a}`:"",organizationTypeColors[0]);case 1:return"light"===n?PSA.badges.custom(t||e,a?`badge-${a} badge-light-dark`:"",null,organizationTypeColors[1]):PSA.badges.custom(t||e,a?`badge-${a}`:"",organizationTypeColors[1]);case 2:return"light"===n?PSA.badges.custom(t||e,a?`badge-${a} badge-light-dark`:"",null,organizationTypeColors[2]):PSA.badges.custom(t||e,a?`badge-${a}`:"",organizationTypeColors[2]);case 3:return"light"===n?PSA.badges.custom(t||e,a?`badge-${a} badge-light-dark`:"",null,organizationTypeColors[3]):PSA.badges.custom(t||e,a?`badge-${a}`:"",organizationTypeColors[3]);case 4:return"light"===n?PSA.badges.custom(t||e,a?`badge-${a} badge-light-dark`:"",null,organizationTypeColors[4]):PSA.badges.custom(t||e,a?`badge-${a}`:"",organizationTypeColors[4]);case 5:return"light"===n?PSA.badges.custom(t||e,a?`badge-${a} badge-light-dark`:"",null,organizationTypeColors[5]):PSA.badges.custom(t||e,a?`badge-${a}`:"",organizationTypeColors[5]);default:return"light"===n?PSA.badges.custom(t||e,a?`badge-${a} badge-light-dark`:"",null,organizationTypeColors[6]):PSA.badges.custom(t||e,a?`badge-${a}`:"",organizationTypeColors[6])}},operationLevel:(e,t)=>{switch(e){case 1:return PSA.badges.custom(t||e,null,operationLevelColors[0]);case 2:return PSA.badges.custom(t||e,null,operationLevelColors[1]);case 3:return PSA.badges.custom(t||e,null,operationLevelColors[2]);case 4:return PSA.badges.custom(t||e,null,operationLevelColors[3]);default:return t||e}},kpiTargetType:(e,t)=>{switch(e){case"Local":return PSA.badges.success(e||t,!0);case"Federal":return PSA.badges.info(e||t,!0);case"Combine":return PSA.badges.danger(e||t,!0);default:return e||t}},classification:(e,t)=>{switch(e){case"public":return PSA.badges.success(e||t,!0);case"restricted":return PSA.badges.info(e||t,!0);case"confidential":return PSA.badges.warning(e||t,!0);case"topsecret":return PSA.badges.danger(e||t,!0);default:return e||t}},notification:e=>{switch(e){case"info":return PSA.badges.info(__(e));case"warning":return PSA.badges.warning(__(e));case"success":return PSA.badges.success(__(e));case"error":return PSA.badges.danger(__(e));default:return e||text}},dataChangeStatus:(e,t)=>{switch(e){case"requested":return PSA.badges.info(e||t);case"approved":return PSA.badges.success(e||t);case"rejected":return PSA.badges.danger(e||t);case"returned":return PSA.badges.warning(e||t);default:return e||t}},yesNo:e=>e?PSA.badges.success(__("Yes")):PSA.badges.danger(__("No"))},buttons:{tableMenu:e=>`\n    <div class="ms-2">\n          <button type="button" class="btn btn-sm btn-icon btn-light btn-active-light-primary me-2" data-kt-menu-trigger="click" data-kt-menu-placement="bottom-end">\n              <span class="svg-icon svg-icon-5 m-0">\n                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">\n                      <rect x="10" y="10" width="4" height="4" rx="2" fill="black" />\n                      <rect x="17" y="10" width="4" height="4" rx="2" fill="black" />\n                      <rect x="3" y="10" width="4" height="4" rx="2" fill="black" />\n                  </svg>\n              </span>\n          </button>\n          <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg-light-primary fw-bold fs-7 w-200px py-4" data-kt-menu="true">\n              ${e}\n          </div>\n      </div>\n    `,table:({url:e,title:t,theme:a="primary",icon:n="flaticon2-gear",onClick:s})=>`\n    <a  class="tbl-tp btn btn-sm btn-icon btn-bg-light btn-active-color-${a}" \n            data-bs-toggle="tooltip" data-bs-placement="top" title="${t}"\n             href="${e?BASE_URL+e:"javascript:void(0)"}" onclick="${s||null}">\n             <i class="${n}"></i>\n         </a>\n    `,tableActiveInactive:({active:e,id:t,url:a})=>`\n    <button \n        class="tbl-tp btn btn-sm btn-icon btn-bg-light ${e?"btn-active-color-danger":"btn-active-color-success"} "\n               href="javascript:;" \n               data-bs-toggle="tooltip" data-bs-placement="top" title="${e?__("Inactive"):__("Active")}"\n               onclick="document.getElementById('${t}').submit();">\n               <i class="fa ${e?"fa-times":"fa-check"}"></i>\n   </button>\n    <form \n        method="post" \n        action="${BASE_URL}${a}/status/?_method=PUT"\n                          id="${t}">\n    </form>\n    `},exception:{catch:e=>{PSA.loading(!1),PSA.toast.error(e&&e.message?e.message:"Something went wrong")}},confirmation:({title:e=__("Confirmation"),body:t,success:a,icon:n="warning"})=>new Promise(((s,o)=>{Swal.fire({title:e,text:t,icon:n,showCancelButton:!0,confirmButtonText:__("Yes"),cancelButtonText:__("No")}).then((e=>{e.value?(a&&Swal.fire(a.title,a.body,"success"),s({success:({title:e=__("Success"),body:t})=>{Swal.fire(e,t,"success")},error:({title:e=__("Error"),body:t})=>{Swal.fire(e,t,"error")}})):o()}))})),loading(e=!0){e?document.body.classList.add("page-loading"):document.body.classList.remove("page-loading")},loadingBlock(e="body",t=!0){if(t)document.querySelector(e).innerHTML='<div class="spinner d-flex justify-content-center">\n        <span class="spinner-border text-primary" role="status">\n          <span class="visually-hidden">Loading...</span>\n        </span>\n      </div> ';else{const t=document.querySelector(e);if(t)for(const e of t.getElementsByClassName("spinner"))e.remove()}},nameToIcon(e,t,a){const n="ar"===a?e:t,s=["warning","primary","success","danger"],o=Math.floor(Math.random()*s.length);return`\n    <div class="symbol-label bg-light-${s[o]}">\n        <span class="text-${s[o]}">${n.charAt(0)}</span>\n    </div>`},courseRequestApprovalLabel:(e,t,a,n)=>n?`<span class="badge badge-sm badge-light-danger d-inline">${__("Rejected")}</span>`:e?`<span class="badge badge-sm badge-light-success d-inline">${__("Final Approval")}</span>`:t&&a?`\n      <span class="badge badge-sm badge-light-info d-inline m-1">${__("HR Approval")}</span>\n      <span class="badge badge-sm badge-light-primary d-inline m-1">${__("Initial Approval")}</span>\n      `:t?`\n      <span class="badge badge-sm badge-light-info d-inline m-1">${__("HR Approval")}</span>\n    `:a?`\n      <span class="badge badge-sm badge-light-primary d-inline m-1">${__("Initial Approval")}</span>\n    `:`\n      <span class="badge badge-sm badge-light-warning d-inline m-1">${__("Not Approved")} </span>\n    `};$(document).ready((e=>{!function(e){e.fn.serializeFormJSON=function(t,a=!0){let n={};const s=this.serializeArray();e.each(s,(function(){n[this.name]?(n[this.name].push||(n[this.name]=[n[this.name]]),n[this.name].push(this.value||"")):n[this.name]=this.value||""})),t&&(n={...n,...t});const o=a?JSON.stringify(n):n;return n?o:null}}(jQuery),function(e){e.fn.serializeFormJSON=function(t,a=!0){let n={};const s=this.serializeArray();e.each(s,(function(){n[this.name]?(n[this.name].push||(n[this.name]=[n[this.name]]),n[this.name].push(this.value||"")):n[this.name]=this.value||""})),t&&(n={...n,...t});const o=a?JSON.stringify(n):n;return n?o:null}}(jQuery)}));